# Test config - embeddinggemma model

# Embedding configuration
embedding:
  provider: "llm"
  model: "embeddinggemma:latest"
  dimension: 768
  normalize: true

# Storage
storage:
  db_path: "matt_embeddinggemma.db"

# Retrieval
retrieval:
  default_limit: 5

# M2: Content hygiene (quality firewall)
hygiene:
  min_chars: 12
  max_chars: 4000
  normalize_whitespace: true
  reject_exact_duplicates: true
  near_duplicate:
    enabled: true
    threshold: 0.92
    skip_manual_source: true

# Document ingestion (LLM-based memory extraction)
ingestion:
  model: cerebras-gpt-oss-120b
  chunk_size: 10000
  chunk_overlap: 500
  min_confidence: 0.8
  format: auto
  force_entities: []
  claude_session:
    include_roles:
      - user
      - assistant
    include_message_types:
      - text
    drop_thinking: true
    drop_tool_use: true

# Prompt configuration
prompts:
  extract_memories: "extract_memories_from_session"
  summary: "summary_v2"

# M3: Time & Truth (TraceRank, temporal ranking)
m3:
  event_logging:
    enabled: true

  tracerank:
    enabled: true
    tau_days: 21
    cooldown_hours: 24
    burst_discount: 0.2
    k: 0.35

  retrieval:
    include_expired: false

# M4: Graph Layer (entities, edges, traversal)
m4:
  entity_types:
    allowed_types:
      - PERSON
      - ORG
      - SYSTEM
      - PROJECT
      - PLACE
      - SKILL
      - TOOL
      - FILE
      - CONCEPT

  entity_extraction:
    enabled: true
    mode: llm

    llm:
      model: claude-haiku-4.5
      max_entities_per_memory: 10
      min_confidence: 0.75
      store_low_confidence: false
      max_evidence_length: 200

    heuristics:
      strip_titles: true
      normalize_org_suffixes: true
      reject_garbage: true
      split_lists: false

  edge_creation:
    mentions:
      enabled: true
      default_weight: 1.0
      confidence_gated: true

    related:
      enabled: true
      similarity_threshold: 0.7
      max_edges_per_memory: 10

  graph_expansion:
    enabled: true
    max_expand_via_entities: 3
    max_expand_via_related: 3
    include_expired: false
    min_confidence: 0.75
