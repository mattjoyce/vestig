# Vestig LLM Prompts
# Use {{token}} for variable substitution

# M4: Entity Extraction (LLM-based)
extract_entities: |
  Extract entities from the following memory content.

  Allowed entity types: {{allowed_types}}

  Rules:
  1. Only extract entities that clearly appear in the text
  2. Assign a confidence score (0.0-1.0) based on how certain you are
  3. Provide brief evidence (max 200 chars) explaining why this is an entity
  4. Focus on concrete names, not abstract concepts
  5. Prefer full names over partial mentions

  Memory content:
  {{content}}

  Output ONLY valid JSON in this exact format:
  {
    "entities": [
      {
        "name": "exact name as it appears or normalized form",
        "type": "PERSON|ORG|SYSTEM|PROJECT|PLACE",
        "confidence": 0.0-1.0,
        "evidence": "short explanation"
      }
    ]
  }

  If no entities found, return: {"entities": []}

# Session Ingestion: Extract memories from conversation transcripts
extract_memories_from_session: |
  Extract discrete, factual memories from this conversation transcript.

  Guidelines:
  1. Extract ONE clear fact, decision, insight, or piece of knowledge per memory
  2. Each memory should be self-contained with enough context to understand it independently
  3. Focus on substantive content (technical details, decisions, learnings, etc.)
  4. Skip greetings, small talk, and purely procedural exchanges
  5. Preserve important context (who said/did what, when applicable)
  6. Assign confidence based on how clear and factual the information is

  Conversation chunk:
  {{content}}

  Output ONLY valid JSON in this exact format:
  {
    "memories": [
      {
        "content": "The full memory text with enough context to be self-contained",
        "confidence": 0.0-1.0,
        "rationale": "Brief explanation of why this is worth remembering"
      }
    ]
  }

  If no substantive memories found, return: {"memories": []}
